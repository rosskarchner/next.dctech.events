<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit an Event - DC Tech Events</title>
  <meta name="description" content="Submit a tech event to DC Tech Events">
  <link rel="stylesheet" href="/static/css/main.css">
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <style>
    .submit-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .submit-container h2 {
      margin-bottom: var(--spacing-lg);
    }

    .event-section {
      border: 1px solid var(--color-border);
      border-radius: 5px;
      padding: 20px;
      margin-bottom: var(--spacing-lg);
    }

    .event-section h3 {
      margin-top: 0;
      margin-bottom: var(--spacing-lg);
      font-size: 1.25rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-lg);
    }

    @media (max-width: 640px) {
      .form-row {
        grid-template-columns: 1fr;
      }
    }

    .form-group {
      margin-bottom: var(--spacing-lg);
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: var(--spacing-sm);
      color: var(--color-text);
    }

    .form-group label .required {
      color: #dc2626;
      font-weight: bold;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: var(--spacing-sm);
      border: 1px solid var(--color-border);
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-family: inherit;
      box-sizing: border-box;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-group small {
      display: block;
      margin-top: var(--spacing-xs);
      color: var(--color-text-light);
      font-size: 0.875rem;
    }

    .time-selector {
      display: flex;
      gap: var(--spacing-sm);
    }

    .time-selector select {
      flex: 1;
    }

    .optional-details {
      margin-top: var(--spacing-lg);
      border-top: 1px solid var(--color-border);
      padding-top: var(--spacing-lg);
    }

    .optional-details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--color-primary);
      padding: var(--spacing-sm) 0;
      list-style-position: inside;
    }

    .optional-details summary:hover {
      color: var(--color-primary-hover);
    }

    .optional-fields {
      padding-top: var(--spacing-lg);
    }

    .btn {
      padding: var(--spacing-sm) var(--spacing-lg);
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      text-decoration: none;
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--color-primary-hover);
    }

    .btn-primary:disabled {
      background-color: var(--color-text-lighter);
      cursor: not-allowed;
    }

    .btn-secondary {
      background-color: var(--color-background-alt);
      color: var(--color-text);
      border: 1px solid var(--color-border);
    }

    .btn-secondary:hover {
      background-color: var(--color-border);
    }

    .form-actions {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-xl);
    }

    .status-message {
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      margin-bottom: var(--spacing-md);
    }

    .status-message.error {
      background-color: #fef2f2;
      border: 1px solid #fca5a5;
      color: #991b1b;
    }

    .status-message.success {
      background-color: #f0fdf4;
      border: 1px solid #86efac;
      color: #166534;
    }

    .status-message.info {
      background-color: #eff6ff;
      border: 1px solid #93c5fd;
      color: #1e40af;
    }

    .success-box {
      padding: var(--spacing-xl);
      background-color: #f0fdf4;
      border: 2px solid #86efac;
      border-radius: var(--border-radius);
    }

    .success-box h3 {
      color: #166534;
      margin-top: 0;
    }
  </style>
</head>

<body>
  <header>
    <h1 class="logo"><a href="/">DC Tech Events</a></h1>
    <div>
      <div>Technology conferences and meetups in and around Washington, DC</div>
      <nav>
        <a href="/locations/">Locations</a> |
        <a href="/locations/dc/">Washington DC</a> |
        <a href="/locations/va/">Virginia</a> |
        <a href="/locations/md/">Maryland</a> |
        <a href="/groups/">Groups</a> |
        <a href="/submit/">Submit Event</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="submit-container">
      <h2>Submit events to DC Tech Events</h2>

      <form id="event-form" hx-post="/submit/" hx-target="#result" hx-swap="innerHTML">
        <div class="event-section">
          <h3>Event Details</h3>

          <div class="form-group">
            <label for="title">Event Title <span class="required">*</span></label>
            <input type="text" id="title" name="title" required maxlength="200"
              placeholder="e.g., Python User Group Monthly Meetup" autocomplete="off">
          </div>

          <div class="form-group">
            <label for="url">Event URL <span class="required">*</span></label>
            <input type="url" id="url" name="url" required placeholder="https://example.com/event" autocomplete="url">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="date">Date <span class="required">*</span></label>
              <input type="date" id="date" name="date" required autocomplete="off">
            </div>

            <div class="form-group">
              <label for="time">Time <span class="required">*</span></label>
              <div class="time-selector">
                <select id="time-hour" name="time-hour" required>
                  <option value="">Hour</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>
                <select id="time-minute" name="time-minute" required>
                  <option value="">Min</option>
                  <option value="00">00</option>
                  <option value="15">15</option>
                  <option value="30">30</option>
                  <option value="45">45</option>
                </select>
                <select id="time-ampm" name="time-ampm" required>
                  <option value="">AM/PM</option>
                  <option value="AM">AM</option>
                  <option value="PM">PM</option>
                </select>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="location">Location <span class="required">*</span></label>
            <input type="text" id="location" name="location" required maxlength="200"
              placeholder="123 Main St, Washington, DC 20001" autocomplete="off">
          </div>

          <details class="optional-details">
            <summary>Optional Details</summary>
            <div class="optional-fields">
              <div class="form-group">
                <label for="end_date">End Date</label>
                <input type="date" id="end_date" name="end_date" autocomplete="off">
                <small>For multi-day events</small>
              </div>

              <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4" autocomplete="off"></textarea>
              </div>

              <div class="form-group">
                <label for="cost">Cost</label>
                <input type="text" id="cost" name="cost" maxlength="100" placeholder="e.g., Free, $10, $5-$15"
                  autocomplete="off">
              </div>

              <div class="form-group">
                <label for="topicSlug">Topic</label>
                <select id="topicSlug" name="topicSlug">
                  <option value="">-- Select a topic --</option>
                  {{#each topics}}
                  <option value="{{slug}}">{{name}}</option>
                  {{/each}}
                </select>
                <small>Categorize this event by topic</small>
              </div>
            </div>
          </details>

        </div>

        <div id="result"></div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Submit Event</button>
          <a href="/" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </main>

  <footer>
    <p>&copy; {{year}} DC Tech Events</p>
  </footer>

  <script>
    // Set default date to tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    const dateString = tomorrow.toISOString().split('T')[0];
    document.getElementById('date').value = dateString;

    // Set default time to 6:30 PM
    document.getElementById('time-hour').value = '6';
    document.getElementById('time-minute').value = '30';
    document.getElementById('time-ampm').value = 'PM';

    // Convert time selectors to HH:MM format before submission
    document.getElementById('event-form').addEventListener('htmx:configRequest', function (evt) {
      const hour = document.getElementById('time-hour').value;
      const minute = document.getElementById('time-minute').value;
      const ampm = document.getElementById('time-ampm').value;

      if (hour && minute && ampm) {
        let hour24 = parseInt(hour);
        if (ampm === 'PM' && hour24 !== 12) {
          hour24 += 12;
        } else if (ampm === 'AM' && hour24 === 12) {
          hour24 = 0;
        }

        const timeString = `${String(hour24).padStart(2, '0')}:${minute}`;
        evt.detail.parameters['time'] = timeString;
      }

      // Remove the individual time components
      delete evt.detail.parameters['time-hour'];
      delete evt.detail.parameters['time-minute'];
      delete evt.detail.parameters['time-ampm'];
    });
  </script>
</body>

</html>