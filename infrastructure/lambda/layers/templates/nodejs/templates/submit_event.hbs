<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit an Event - DC Tech Events</title>
  <meta name="description" content="Submit a tech event to DC Tech Events">
  <link rel="stylesheet" href="/static/css/main.css">
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
  <style>
    .submit-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .submit-container h2 {
      margin-bottom: var(--spacing-lg);
    }

    .event-section {
      border: 1px solid var(--color-border);
      border-radius: 5px;
      padding: 20px;
      margin-bottom: var(--spacing-lg);
    }

    .event-section h3 {
      margin-top: 0;
      margin-bottom: var(--spacing-lg);
      font-size: 1.25rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-lg);
    }

    @media (max-width: 640px) {
      .form-row {
        grid-template-columns: 1fr;
      }
    }

    .form-group {
      margin-bottom: var(--spacing-lg);
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: var(--spacing-sm);
      color: var(--color-text);
    }

    .form-group label .required {
      color: #dc2626;
      font-weight: bold;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: var(--spacing-sm);
      border: 1px solid var(--color-border);
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-family: inherit;
      box-sizing: border-box;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-group small {
      display: block;
      margin-top: var(--spacing-xs);
      color: var(--color-text-light);
      font-size: 0.875rem;
    }

    .time-selector {
      display: flex;
      gap: var(--spacing-sm);
    }

    .time-selector select {
      flex: 1;
    }

    /* Event Type Toggle */
    .event-type-toggle {
      display: flex;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .event-type-option {
      flex: 1;
      position: relative;
    }

    .event-type-option input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .event-type-option label {
      display: block;
      padding: var(--spacing-md);
      border: 2px solid var(--color-border);
      border-radius: var(--border-radius);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .event-type-option label:hover {
      border-color: var(--color-primary);
    }

    .event-type-option input[type="radio"]:checked+label {
      border-color: var(--color-primary);
      background: rgba(37, 99, 235, 0.05);
    }

    .event-type-option .type-title {
      font-weight: 600;
      display: block;
      margin-bottom: var(--spacing-xs);
    }

    .event-type-option .type-desc {
      font-size: 0.875rem;
      color: var(--color-text-light);
    }

    /* Native Event Options */
    .native-options {
      background: var(--color-background-alt);
      border-radius: var(--border-radius);
      padding: var(--spacing-lg);
      margin-top: var(--spacing-md);
      display: none;
    }

    .native-options.visible {
      display: block;
    }

    .native-options h4 {
      margin-top: 0;
      margin-bottom: var(--spacing-md);
      font-size: 1rem;
    }

    .checkbox-group {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-md);
    }

    .checkbox-group input[type="checkbox"] {
      width: auto;
      margin-top: 3px;
    }

    .checkbox-group label {
      margin-bottom: 0;
      font-weight: normal;
    }

    .checkbox-group small {
      display: block;
      margin-top: 4px;
      color: var(--color-text-light);
      font-size: 0.8rem;
    }

    .rsvp-privacy-note {
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: var(--border-radius);
      padding: var(--spacing-sm);
      font-size: 0.875rem;
      margin-top: var(--spacing-md);
    }

    .optional-details {
      margin-top: var(--spacing-lg);
      border-top: 1px solid var(--color-border);
      padding-top: var(--spacing-lg);
    }

    .optional-details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--color-primary);
      padding: var(--spacing-sm) 0;
      list-style-position: inside;
    }

    .optional-details summary:hover {
      color: var(--color-primary-hover);
    }

    .optional-fields {
      padding-top: var(--spacing-lg);
    }

    .btn {
      padding: var(--spacing-sm) var(--spacing-lg);
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      text-decoration: none;
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--color-primary-hover);
    }

    .btn-primary:disabled {
      background-color: var(--color-text-lighter);
      cursor: not-allowed;
    }

    .btn-secondary {
      background-color: var(--color-background-alt);
      color: var(--color-text);
      border: 1px solid var(--color-border);
    }

    .btn-secondary:hover {
      background-color: var(--color-border);
    }

    .form-actions {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-xl);
    }

    .status-message {
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
      margin-bottom: var(--spacing-md);
    }

    .status-message.error {
      background-color: #fef2f2;
      border: 1px solid #fca5a5;
      color: #991b1b;
    }

    .status-message.success {
      background-color: #f0fdf4;
      border: 1px solid #86efac;
      color: #166534;
    }

    #url-group {
      transition: opacity 0.2s;
    }

    #url-group.hidden {
      opacity: 0.5;
      pointer-events: none;
    }
  </style>
</head>

<body>
  {{> header}}

  <main class="container">
    <div class="submit-container">
      <h2>Submit an Event</h2>

      <form id="event-form" hx-post="/submit/" hx-target="#result" hx-swap="innerHTML">
        <div class="event-section">
          <h3>Event Type</h3>

          <div class="event-type-toggle">
            <div class="event-type-option">
              <input type="radio" id="type-external" name="eventType" value="external" checked>
              <label for="type-external">
                <span class="type-title">üîó Link to External Page</span>
                <span class="type-desc">Link to Meetup, Eventbrite, etc.</span>
              </label>
            </div>
            <div class="event-type-option">
              <input type="radio" id="type-native" name="eventType" value="native">
              <label for="type-native">
                <span class="type-title">üè† Host on DC Tech Events</span>
                <span class="type-desc">Create a page here with RSVP</span>
              </label>
            </div>
          </div>

          <!-- Native Event Options (shown when native is selected) -->
          <div id="native-options" class="native-options">
            <h4>RSVP Settings</h4>

            <div class="checkbox-group">
              <input type="checkbox" id="rsvpEnabled" name="rsvpEnabled" value="true" checked>
              <div>
                <label for="rsvpEnabled">Enable RSVP</label>
                <small>Allow users to indicate they're attending</small>
              </div>
            </div>

            <div class="form-group" id="rsvp-limit-group">
              <label for="rsvpLimit">Attendee Limit (optional)</label>
              <input type="number" id="rsvpLimit" name="rsvpLimit" min="1" placeholder="Leave blank for unlimited">
              <small>Maximum number of attendees</small>
            </div>

            <div class="checkbox-group">
              <input type="checkbox" id="showRsvpList" name="showRsvpList" value="true" checked>
              <div>
                <label for="showRsvpList">Show attendee list publicly</label>
                <small>Display names of people who RSVP</small>
              </div>
            </div>

            <div class="rsvp-privacy-note">
              <strong>Note:</strong> As the event organizer, you can always see all attendees regardless of their
              privacy settings.
            </div>
          </div>
        </div>

        <div class="event-section">
          <h3>Event Details</h3>

          <div class="form-group">
            <label for="title">Event Title <span class="required">*</span></label>
            <input type="text" id="title" name="title" required maxlength="200"
              placeholder="e.g., Python User Group Monthly Meetup" autocomplete="off">
          </div>

          <div class="form-group" id="url-group">
            <label for="url">Event URL <span class="required">*</span></label>
            <input type="url" id="url" name="url" placeholder="https://example.com/event" autocomplete="url">
            <small>Link to the event page on Meetup, Eventbrite, etc.</small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="date">Date <span class="required">*</span></label>
              <input type="date" id="date" name="date" required autocomplete="off">
            </div>

            <div class="form-group">
              <label for="time">Time <span class="required">*</span></label>
              <div class="time-selector">
                <select id="time-hour" name="time-hour" required>
                  <option value="">Hour</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>
                <select id="time-minute" name="time-minute" required>
                  <option value="">Min</option>
                  <option value="00">00</option>
                  <option value="15">15</option>
                  <option value="30">30</option>
                  <option value="45">45</option>
                </select>
                <select id="time-ampm" name="time-ampm" required>
                  <option value="">AM/PM</option>
                  <option value="AM">AM</option>
                  <option value="PM">PM</option>
                </select>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="location">Location <span class="required">*</span></label>
            <input type="text" id="location" name="location" required maxlength="200"
              placeholder="123 Main St, Washington, DC 20001" autocomplete="off">
          </div>

          <details class="optional-details">
            <summary>Optional Details</summary>
            <div class="optional-fields">
              <div class="form-group">
                <label for="end_date">End Date</label>
                <input type="date" id="end_date" name="end_date" autocomplete="off">
                <small>For multi-day events</small>
              </div>

              <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4" autocomplete="off"
                  placeholder="Describe the event..."></textarea>
              </div>

              <div class="form-group">
                <label for="cost">Cost</label>
                <input type="text" id="cost" name="cost" maxlength="100" placeholder="e.g., Free, $10, $5-$15"
                  autocomplete="off">
              </div>

              <div class="form-group">
                <label for="topicSlug">Topic</label>
                <select id="topicSlug" name="topicSlug">
                  <option value="">-- Select a topic --</option>
                  {{#each topics}}
                  <option value="{{slug}}">{{name}}</option>
                  {{/each}}
                </select>
                <small>Categorize this event by topic</small>
              </div>

              <div class="form-group">
                <label for="recurrenceRule">Recurrence (Optional)</label>
                <select id="recurrenceRule" name="recurrenceRule">
                  <option value="">One-time event</option>
                  <optgroup label="Weekly">
                    <option value="WEEKLY:SUN">Every Sunday</option>
                    <option value="WEEKLY:MON">Every Monday</option>
                    <option value="WEEKLY:TUE">Every Tuesday</option>
                    <option value="WEEKLY:WED">Every Wednesday</option>
                    <option value="WEEKLY:THU">Every Thursday</option>
                    <option value="WEEKLY:FRI">Every Friday</option>
                    <option value="WEEKLY:SAT">Every Saturday</option>
                  </optgroup>
                  <optgroup label="Monthly">
                    <option value="MONTHLY:1:MON">1st Monday of month</option>
                    <option value="MONTHLY:1:TUE">1st Tuesday of month</option>
                    <option value="MONTHLY:1:WED">1st Wednesday of month</option>
                    <option value="MONTHLY:1:THU">1st Thursday of month</option>
                    <option value="MONTHLY:2:MON">2nd Monday of month</option>
                    <option value="MONTHLY:2:TUE">2nd Tuesday of month</option>
                    <option value="MONTHLY:2:WED">2nd Wednesday of month</option>
                    <option value="MONTHLY:2:THU">2nd Thursday of month</option>
                    <option value="MONTHLY:3:MON">3rd Monday of month</option>
                    <option value="MONTHLY:3:TUE">3rd Tuesday of month</option>
                    <option value="MONTHLY:3:WED">3rd Wednesday of month</option>
                    <option value="MONTHLY:3:THU">3rd Thursday of month</option>
                    <option value="MONTHLY:4:MON">4th Monday of month</option>
                    <option value="MONTHLY:4:TUE">4th Tuesday of month</option>
                    <option value="MONTHLY:4:WED">4th Wednesday of month</option>
                    <option value="MONTHLY:4:THU">4th Thursday of month</option>
                    <option value="MONTHLY:LAST:MON">Last Monday of month</option>
                    <option value="MONTHLY:LAST:TUE">Last Tuesday of month</option>
                    <option value="MONTHLY:LAST:WED">Last Wednesday of month</option>
                    <option value="MONTHLY:LAST:THU">Last Thursday of month</option>
                  </optgroup>
                </select>
                <small>Recurring events will be automatically expanded for the next 90 days</small>
              </div>
            </div>
          </details>

        </div>

        <div id="result"></div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Submit Event</button>
          <a href="/" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </main>

  {{> footer}}

  <script>
    // Toggle native options visibility based on event type
    const typeExternal = document.getElementById('type-external');
    const typeNative = document.getElementById('type-native');
    const nativeOptions = document.getElementById('native-options');
    const urlGroup = document.getElementById('url-group');
    const urlInput = document.getElementById('url');

    function updateFormForEventType() {
      const isNative = typeNative.checked;

      if (isNative) {
        nativeOptions.classList.add('visible');
        urlGroup.classList.add('hidden');
        urlInput.removeAttribute('required');
      } else {
        nativeOptions.classList.remove('visible');
        urlGroup.classList.remove('hidden');
        urlInput.setAttribute('required', 'required');
      }
    }

    typeExternal.addEventListener('change', updateFormForEventType);
    typeNative.addEventListener('change', updateFormForEventType);

    // Toggle RSVP limit visibility based on RSVP enabled
    const rsvpEnabled = document.getElementById('rsvpEnabled');
    const rsvpLimitGroup = document.getElementById('rsvp-limit-group');
    const showRsvpListCheckbox = document.getElementById('showRsvpList');

    rsvpEnabled.addEventListener('change', function () {
      const isEnabled = this.checked;
      rsvpLimitGroup.style.opacity = isEnabled ? '1' : '0.5';
      rsvpLimitGroup.style.pointerEvents = isEnabled ? 'auto' : 'none';
      showRsvpListCheckbox.parentElement.parentElement.style.opacity = isEnabled ? '1' : '0.5';
      showRsvpListCheckbox.parentElement.parentElement.style.pointerEvents = isEnabled ? 'auto' : 'none';
    });

    // Set default date to tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    const dateString = tomorrow.toISOString().split('T')[0];
    document.getElementById('date').value = dateString;

    // Set default time to 6:30 PM
    document.getElementById('time-hour').value = '6';
    document.getElementById('time-minute').value = '30';
    document.getElementById('time-ampm').value = 'PM';

    // Convert time selectors to HH:MM format before submission
    document.getElementById('event-form').addEventListener('htmx:configRequest', function (evt) {
      const hour = document.getElementById('time-hour').value;
      const minute = document.getElementById('time-minute').value;
      const ampm = document.getElementById('time-ampm').value;

      if (hour && minute && ampm) {
        let hour24 = parseInt(hour);
        if (ampm === 'PM' && hour24 !== 12) {
          hour24 += 12;
        } else if (ampm === 'AM' && hour24 === 12) {
          hour24 = 0;
        }

        const timeString = `${String(hour24).padStart(2, '0')}:${minute}`;
        evt.detail.parameters['time'] = timeString;
      }

      // Remove the individual time components
      delete evt.detail.parameters['time-hour'];
      delete evt.detail.parameters['time-minute'];
      delete evt.detail.parameters['time-ampm'];
    });
  </script>
</body>

</html>
</CodeContent>
<parameter name="Description">Redesigned the event submission form with a unified interface for both external links and
  native events. Users can toggle between linking to an external event page or hosting the event directly on DC Tech
  Events with RSVP functionality and privacy settings.